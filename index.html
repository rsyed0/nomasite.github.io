<!DOCTYPE HTML>
<!--
	Stellar by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Noma Melanoma Diagnosis</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>

		<link rel="shortcut icon" type="image/png" href="favicon.png"/>
	</head>
	<body class="is-preload">

		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Header -->
					<header id="header" class="alt">
						<span class="logo"><img src="favicon.png" alt="" /></span>
						<h1>Noma</h1>
						<p>Welcome to the future of melanoma diagnosis.<br />
					</header>

				<!-- Nav -->
					<nav id="nav">
						<ul>
							<li><a href="#intro" class="active">Introduction</a></li>
							<li><a href="#cta">Get Started</a></li>
						</ul>
					</nav>

				<!-- Main -->
					<div id="main">

						<!-- Introduction -->
						<section id="intro" class="main">
							<div class="spotlight">
								<div class="content">
									<header class="major">
										<h2>What It Is</h2>
									</header>
									<p>Melanoma is a serious disease that can be easily removed if treated early on. With early surgical
									removal, the five year survival rate is 98% (ISIC Archive). However, if this dangerous disease is allowed
									to metastasize, or spread to other parts of the body, then the mortality rises dramatically.
									<br><br>
									The issue is accessibility to high-quality diagnostic devices that are only available at a healthcare
									provider. As millions of Americans do not have health coverage, and millions more do not visit their
									doctors frequently enough to screen the disease, there has to be a better way.
									<br><br>
									Enter Noma. Our web-based and Android application takes microscopic images uploaded by the user and
									uses a deep convolutional neural network to determine the possibility of the presence of cancerous tissue 
									in the image. It then reports this diagnosis to the user. Noma removes the barrier to effective diagnosis
									and helps people survive, and thrive.</p>
								</div>
								<span class="image"><img src="images/sample.png" alt="" /></span>
							</div>
						</section>

						<!-- Get Started -->
						<section id="cta" class="main special">
							<header class="major">
								<h2>Get Started</h2>
								<p>Simply select your file by dragging it into the zone below.<br />
								Thanks for using Noma.</p>
							</header>

							<br>

							<center>
								<!--<input type="file" id="files" class="button" name="files[]" multiple />

								<br><br>

								<output id="list"></output>

								<br><br>-->

								<div id="drop_zone" class="button">Drop files here</div>
								<output id="list"></output>

								<script>
								  function handleFileSelect(evt) {
								    evt.stopPropagation();
								    evt.preventDefault();

								    var files = evt.dataTransfer.files; // FileList object.

								    // files is a FileList of File objects. List some properties.
								    var output = [];

								    const model = new KerasJS.Model({
									  	filepath: 'melanoma.h5',
											filesystem: true
									});

								    // just the first image
								    f = files[0];

							        output.push('<li><strong>', escape(f.name), '</strong> (', f.type || 'n/a', ') - ',
							                  f.size, ' bytes, last modified: ',
							                  f.lastModifiedDate ? f.lastModifiedDate.toLocaleDateString() : 'n/a',
							                  '</li>');

							        document.getElementById('list').innerHTML = '<ul>' + output.join('') + '</ul>';

						      		// Run network with Keras.JS
							      	model
								  	.ready()
								  	.then(() => {

								  		// convert file to image
								  		document.getElementById('file-input').onchange = function (e) {
										    loadImage(f,
										        function (img) {
										            document.body.appendChild(img);
										        },
										        {} // Options
										    );
										};

								  		// convert image to RGB array
								  		ctx.drawImage(img, 0, 0);
										var data = ctx.getImageData(x, y, width, height).data;

								    	// get input data from file
								    	const inputData = {
								      		input_1: new Float32Array(data)
								    	}

								    	// make predictions
								    	return model.predict(inputData)
								 	})
								  	.then(outputData => {
								    	// analyze output
								    	var out = outputData[0];
								    	document.write(out+"");
								  	})
								  	.catch(err => {
								    	// handle error
								  	});
								  }

								  function handleDragOver(evt) {
								    evt.stopPropagation();
								    evt.preventDefault();
								    evt.dataTransfer.dropEffect = 'copy'; // Explicitly show this is a copy.
								  }

								  // Setup the dnd listeners.
								  var dropZone = document.getElementById('drop_zone');
								  dropZone.addEventListener('dragover', handleDragOver, false);
								  dropZone.addEventListener('drop', handleFileSelect, false);
								</script>
							</center>

							<br>
						</section>

					</div>

				<!-- Footer -->
					<footer id="footer">
						<br><br>
					</footer>

			</div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.scrollex.min.js"></script>
			<script src="assets/js/jquery.scrolly.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>
			<script src="assets/js/loadimage.min.js"></script>
			<script src="https://unpkg.com/keras-js"></script>

	</body>
</html>